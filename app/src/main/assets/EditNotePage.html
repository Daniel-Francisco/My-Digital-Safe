<!DOCTYPE html>
<html>

		<head>
			<html lang="en">
			<meta charset="utf-8">
			<meta name="viewport" content="width=device-width, initial-scale=1">
			</html>
			<!-- Latest compiled and minified CSS -->
			<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

			<!-- jQuery library -->
			<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

			<!-- Latest compiled JavaScript -->
			<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

			<link rel="stylesheet" href="./css/style.css">
			<link rel="stylesheet" href="./css/EditNotePage.css">

		</head>
	<body>
		<div id="page">
			<input id="editNoteTitle" oninput="updateFile()" class="title" type="text"/>
			<textarea id="noteArea" oninput="updateFile()" rows="30"></textarea>
		</div>

		<style>
			#page{
				width: 100%;
				height: 100%;
				display: block;
				margin: auto;
			}
			#noteArea{
				width:100%;
				rows:100;
			}
			#deleteNote{
				display: block;
				position:relative;
				margin: 10px auto;
				float:none;
				color:red;
			}
		</style>

		<script>
			console.log("Test");
			var initialText;// = Android.fetchContents();
			var file;
			var editText;// = $("noteArea");
			var title;
			var titleText;


			function updateJavaString(){
				Android.updateNoteValue(editText.value);
			}

			function updateFile(){
				console.log("Updating file");
				file.data = editText.value;
				file.file_name = title.value;
				var fileString = JSON.stringify(file);
				console.log("File: " + file);
				console.log("FileString: " + fileString);
				Android.updateFile(fileString);
			}

			$(document).ready(function() {
				// {"_id":4,"access_date":"2018-45-17 10:45:54","data":"","file_name":"My Secure Note"}

				console.log("1");
				var fileString = Android.getFile();
				file = JSON.parse(fileString);
				console.log("2");
				console.log(file);
				console.log("3");
				initialText = file.data;
				titleText = file.file_name;
				console.log("4");
				editText = $("noteArea");
				title = $("editNoteTitle");

				console.log("Data = " + initialText);
				console.log("Title = " + titleText);

				title.value = titleText;
				editText.value = initialText;

			});

		</script>

	</body>

</html>