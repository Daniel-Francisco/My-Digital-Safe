<!DOCTYPE html>
<html>

<head>
    <html lang="en">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    </html>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <link rel="stylesheet" href="./css/style.css">
    <link rel="stylesheet" href="./css/main.css">
    <link rel="stylesheet" href="./css/ListPage.css">

</head>

<div id="page">
    <div id="primaryWindow">
        <div id="listWrapper"></div>
        <div id="noNotesComment">Looks like you don't have any notes yet! Click the plus icon in the bottom right corner to get started.</div>
    </div>
</div>


<script>
    var jsonString;
    var wrapper;
    var windowFlag = false;
    var noNotesCommentDiv;

    function renderList(){
        wrapper = document.getElementById("listWrapper");
        wrapper.innerHTML = "";
        jsonString = Android.getData();

        var jsonArray = JSON.parse(jsonString);

        if(jsonArray.length > 0){
            noNotesCommentDiv.classList.add("hide");
        }else{
            // noNotesCommentDiv.classList.remove("hide");
        }

        for(var i = 0; i < jsonArray.length; i++) {
            (function () {

                var baseHtmlStructure = document.createElement("div");
                baseHtmlStructure.classList.add("listItem");

                var dataDiv = document.createElement("div");
                dataDiv.classList.add("dataDiv");

                var deleteAreaDiv = document.createElement("div");
                deleteAreaDiv.classList.add("deleteArea");

                var idDiv = document.createElement("div");
                idDiv.classList.add("id");
                var fileNameDiv = document.createElement("div");
                fileNameDiv.classList.add("fileName");
                var dateDiv = document.createElement("div");
                dateDiv.classList.add("date");

                var file = jsonArray[i];
                var id = file._id;
                var date = file.access_date;
                var fileName = file.file_name;

                idDiv.innerText = id;
                dateDiv.innerText = date;
                fileNameDiv.innerText = fileName;

                var spacerDiv = document.createElement("div");
                spacerDiv.classList.add("spacer");

                dataDiv.appendChild(idDiv);
                dataDiv.appendChild(fileNameDiv);
                dataDiv.appendChild(dateDiv);
                dataDiv.appendChild(spacerDiv);

                baseHtmlStructure.appendChild(dataDiv);
                baseHtmlStructure.appendChild(deleteAreaDiv);

                dataDiv.addEventListener("click", function(){
                    var fileString = JSON.stringify(file);
                    Android.listClickOccurred(fileString);
                });

                var borderDiv = document.createElement("div");
                borderDiv.classList.add("borderDiv");


                wrapper.appendChild(baseHtmlStructure); 


            }());

        }
    }

    $(document).ready(function() {
        noNotesCommentDiv = document.getElementById("noNotesComment");

        renderList();

        $("#closeNewNoteWindowButton").on("click", function(event) {
            event.preventDefault();
            if(windowFlag){
                document.getElementById("primaryWindow").classList.remove("hide");
                document.getElementById("newNoteWindow").classList.add("hide");
            }else{
                document.getElementById("primaryWindow").classList.add("hide");
                document.getElementById("newNoteWindow").classList.remove("hide");
            }
            windowFlag = !windowFlag;
        });
    });

</script>

</html>